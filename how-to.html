<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How-To - FocusHub</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
</head>
<body class="theme-dark" data-theme="dark">
    <!-- Header -->
    <header class="app-header">
        <div class="app-header-content">
            <div class="logo-section">
                <img src="FocusHub_horinorm.svg" alt="FocusHub" class="logo-img" style="height: 40px; width: auto; filter: brightness(0) invert(1);">
            </div>
            
            <div class="header-controls">
                <a href="overview.html" class="btn-home">Dashboard</a>
                <a href="app.html" class="btn-home">Workspace</a>
            </div>
        </div>
    </header>

    <!-- Mobile Jump Menu -->
    <div id="mobileJumpMenu" style="display: none; background: var(--bg-secondary); border-bottom: 1px solid var(--border-medium); padding: 1rem 2rem;">
        <label for="jumpSelect" style="display: block; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 12px; font-weight: 700; letter-spacing: 1px; color: var(--text-secondary); margin-bottom: 0.5rem;">JUMP TO</label>
        <select id="jumpSelect" style="width: 100%; padding: 0.75rem; background: var(--bg-primary); border: 1px solid var(--border-medium); color: var(--text-primary); font-size: 14px; border-radius: 4px;">
            <option value="">Select a topic</option>
            <option value="start-timer">Start timer</option>
            <option value="set-sprints">Set sprints for tasks</option>
            <option value="set-priority">Set task priority</option>
            <option value="drag-drop">Drag and drop tasks</option>
            <option value="review-history">Review session history</option>
            <option value="step-4">Premium Features</option>
        </select>
    </div>

    <!-- Main Content -->
    <div class="container" style="max-width: 1400px; margin: 0 auto; padding: 4rem 2rem;">
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 4rem; align-items: start;">
            
            <!-- Left Column: Main Content -->
            <div>
                <h1 style="font-size: 36px; font-weight: 700; margin-bottom: 3rem; color: var(--text-primary);">How to use FocusHub</h1>

                <!-- Step 1: Start a focus session -->
                <section id="step-1" style="margin-bottom: 4rem;">
                    <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">Start a focus session</h2>
                    
                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-left: 4px solid var(--industrial-orange); margin-bottom: 2rem;">
                        <p style="font-size: 16px; line-height: 1.6; color: var(--text-primary); margin: 0;">
                            Choose a task, start the timer, and work until the session ends. Sessions are time-bounded work periods that enforce focus without requiring motivation.
                        </p>
                    </div>

                    <!-- Expandable Details -->
                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>Why sessions are time-bounded</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Sessions are intentionally constrained by time because open-ended work invites hesitation and overthinking. A fixed endpoint removes the need to decide when to stop, which reduces decision fatigue and forces a start.</p>
                        </div>
                    </div>

                    <div class="detail-section" id="start-timer">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>What to do if focus breaks during a session</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Log the distraction immediately. FocusHub tracks what pulled you away and whether you intended it. This data helps you understand actual focus patterns rather than imagined ones. Continue the session after logging.</p>
                        </div>
                    </div>

                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>How strict the system is intended to be</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Stopping early is allowed but reduces effectiveness. The system works best when used as intended. Strictness is not punishment. It is structure that removes ambiguity about what constitutes work.</p>
                        </div>
                    </div>
                </section>

                <!-- Step 2: Work within the session boundary -->
                <section id="step-2" style="margin-bottom: 4rem;">
                    <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">Work within the session boundary</h2>
                    
                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-left: 4px solid var(--accent-blue); margin-bottom: 2rem;">
                        <p style="font-size: 16px; line-height: 1.6; color: var(--text-primary); margin: 0;">
                            The session defines the work window. Multitasking and task switching are discouraged. Work on the selected task until the timer ends.
                        </p>
                    </div>

                    <!-- Expandable Details -->
                    <div class="detail-section" id="set-sprints">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>What counts as work</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Work is any deliberate action toward completing the selected task. Research, writing, coding, planning, and focused reading all count. Checking unrelated notifications, browsing without purpose, and switching tasks do not.</p>
                        </div>
                    </div>

                    <div class="detail-section" id="set-priority">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>What should be avoided during a session</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Avoid starting new tasks, responding to non-urgent messages, and opening unrelated tools or websites. If something interrupts you, log it and decide whether to continue or stop the session. Do not allow undocumented drift.</p>
                        </div>
                    </div>

                    <div class="detail-section" id="drag-drop">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>How interruptions are handled</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Interruptions happen. Log them when they occur. If the interruption requires action, decide whether to pause the session or continue after handling it. The system tracks both planned and unplanned breaks in focus.</p>
                        </div>
                    </div>
                </section>

                <!-- Step 3: End and review -->
                <section id="step-3" style="margin-bottom: 4rem;">
                    <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">End and review</h2>
                    
                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-left: 4px solid var(--success); margin-bottom: 2rem;">
                        <p style="font-size: 16px; line-height: 1.6; color: var(--text-primary); margin: 0;">
                            When a session ends, record what happened. Review is part of the system, not an afterthought. Session history shows patterns that improve future focus.
                        </p>
                    </div>

                    <!-- Expandable Details -->
                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>How session history is used</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Session history tracks completed sessions, distractions logged, and tasks worked on. This data is used to calculate performance metrics and identify patterns in focus behavior over time.</p>
                        </div>
                    </div>

                    <div class="detail-section" id="review-history">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>What patterns users should look for</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Look for recurring distractions, times of day when focus holds or breaks, and task types that require more or fewer sessions. Patterns reveal where structure helps and where adjustment is needed.</p>
                        </div>
                    </div>

                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>How review supports better future sessions</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Review clarifies what actually happened versus what was intended. This awareness reduces self-deception and allows for realistic planning. Better sessions come from understanding actual behavior, not idealizing future effort.</p>
                        </div>
                    </div>
                </section>

                <!-- Premium Features Section -->
                <section id="step-4" style="margin-bottom: 4rem;">
                    <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">Premium Features</h2>
                    
                    <div style="padding: 1.5rem; background: var(--bg-secondary); border-left: 4px solid #f59e0b; margin-bottom: 2rem;">
                        <p style="font-size: 16px; line-height: 1.6; color: var(--text-primary); margin: 0;">
                            <strong>ðŸ‘‘ Daily Reflection Library (Premium Only)</strong>: Start each day with wisdom from 7 spiritual and philosophical traditions. 350+ unique reflections designed to center your focus before work begins.
                        </p>
                    </div>

                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>What traditions are included?</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p><strong>7 Spiritual & Philosophical Traditions (50 reflections each):</strong></p>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem; line-height: 1.8;">
                                <li><strong>Catholic:</strong> Wisdom from saints, mystics, and Church doctors</li>
                                <li><strong>Protestant:</strong> Reflections from Reformers and evangelical thinkers</li>
                                <li><strong>Stoic:</strong> Ancient philosophy from Marcus Aurelius, Seneca, Epictetus</li>
                                <li><strong>Buddhist:</strong> Teachings on mindfulness, compassion, and presence</li>
                                <li><strong>Islamic:</strong> Insights from Sufi mystics and Islamic scholars</li>
                                <li><strong>Jewish:</strong> Torah wisdom, Talmudic teachings, and Hasidic thought</li>
                                <li><strong>Secular/Humanist:</strong> Rational, evidence-based wisdom for non-religious users</li>
                            </ul>
                            <p style="margin-top: 1rem;">Choose your tradition in Settings. Receive a new reflection each day at the start of your session.</p>
                        </div>
                    </div>

                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>How the reflection library works</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p>Each morning when you open FocusHub, you'll see a reflection from your chosen tradition. Reflections rotate dailyâ€”you won't see the same one twice in a 50-day cycle. The reflection appears at the start screen before you begin work, providing a moment of centering before execution begins.</p>
                        </div>
                    </div>

                    <div class="detail-section">
                        <button class="detail-toggle" aria-expanded="false">
                            <span>Other premium features</span>
                            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="detail-content" hidden>
                            <p><strong>Multi-device sync:</strong> Access your workspace from any device via Supabase sync.</p>
                            <p><strong>Historical analytics:</strong> Track performance trends over weeks and months.</p>
                            <p><strong>Data export:</strong> Download all your data in JSON format.</p>
                            <p><strong>Premium focus modes:</strong> Additional focus features and customization.</p>
                            <p style="margin-top: 1rem;"><em>Beta Status: During beta, all users have full premium access.</em></p>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Right Column: Quick Access Navigation -->
            <div style="position: sticky; top: 100px;">
                <div style="border: 1px solid var(--border-medium); background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px;">
                    <h3 style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 14px; font-weight: 700; letter-spacing: 1px; color: var(--text-secondary); margin-bottom: 1.5rem; text-transform: uppercase;">
                        Quick access
                    </h3>
                    
                    <nav id="quickNav">
                        <a href="#start-timer" class="nav-item" data-section="start-timer">Start timer</a>
                        <a href="#set-sprints" class="nav-item" data-section="set-sprints">Set sprints for tasks</a>
                        <a href="#set-priority" class="nav-item" data-section="set-priority">Set task priority</a>
                        <a href="#drag-drop" class="nav-item" data-section="drag-drop">Drag and drop tasks</a>
                        <a href="#review-history" class="nav-item" data-section="review-history">Review session history</a>
                        <a href="#step-4" class="nav-item" data-section="premium-features">Premium Features</a>
                    </nav>
                </div>

                <!-- AI Support Agent -->
                <div id="aiSupportBox" style="border: 1px solid var(--border-medium); background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px; margin-top: 1.5rem;">
                    <!-- Collapsed State -->
                    <div id="aiSupportCollapsed">
                        <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">Need help?</h3>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 1rem;">Ask FocusHub support</p>
                        <button id="openAiSupport" style="width: 100%; background: var(--industrial-orange); color: white; padding: 0.75rem; border: none; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 14px; font-weight: 600; cursor: pointer; border-radius: 4px;">
                            Start conversation
                        </button>
                    </div>

                    <!-- Expanded State (hidden by default) -->
                    <div id="aiSupportExpanded" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary);">FocusHub Support</h3>
                            <button id="closeAiSupport" style="background: transparent; border: none; color: var(--text-secondary); cursor: pointer; font-size: 20px; padding: 0;">Ã—</button>
                        </div>
                        
                        <div id="chatMessages" style="min-height: 300px; max-height: 400px; overflow-y: auto; margin-bottom: 1rem; padding: 1rem; background: var(--bg-primary); border: 1px solid var(--border-light); border-radius: 4px;">
                            <div style="padding: 0.75rem; background: var(--bg-secondary); border-radius: 4px; margin-bottom: 1rem;">
                                <p style="font-size: 14px; color: var(--text-primary); margin: 0;">Ask questions about how FocusHub works, its features, or troubleshooting.</p>
                            </div>
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <input 
                                type="text" 
                                id="chatInput" 
                                placeholder="Type your question..."
                                style="flex: 1; padding: 0.75rem; background: var(--bg-primary); border: 1px solid var(--border-medium); color: var(--text-primary); font-size: 14px; border-radius: 4px;"
                            >
                            <button id="sendMessage" style="background: var(--industrial-orange); color: white; padding: 0.75rem 1.5rem; border: none; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 14px; font-weight: 600; cursor: pointer; border-radius: 4px;">
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Styles -->
    <style>
        /* Detail Sections */
        .detail-section {
            border: 1px solid var(--border-medium);
            background: var(--bg-secondary);
            margin-bottom: 1px;
        }

        .detail-toggle {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 15px;
            font-weight: 500;
            text-align: left;
            cursor: pointer;
            transition: background 0.2s;
        }

        .detail-toggle:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .detail-toggle:focus {
            outline: 2px solid var(--accent-blue);
            outline-offset: -2px;
        }

        .detail-icon {
            transition: transform 0.2s;
            flex-shrink: 0;
        }

        .detail-toggle[aria-expanded="true"] .detail-icon {
            transform: rotate(180deg);
        }

        .detail-content {
            padding: 0 1.5rem 1rem;
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.6;
        }

        .detail-content p {
            margin: 0;
        }

        /* Quick Nav */
        .nav-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 14px;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-left-color: var(--text-secondary);
        }

        .nav-item.active {
            border-left-color: var(--industrial-orange);
            background: rgba(245, 91, 7, 0.1);
            font-weight: 600;
        }

        /* Mobile */
        @media (max-width: 1024px) {
            [style*="grid-template-columns: 2fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
            
            #quickNav {
                display: none !important;
            }
            
            #mobileJumpMenu {
                display: block !important;
            }
        }
    </style>

    <!-- JavaScript -->
    <script>
        // Detail Toggle
        document.querySelectorAll('.detail-toggle').forEach(button => {
            button.addEventListener('click', () => {
                const expanded = button.getAttribute('aria-expanded') === 'true';
                const content = button.nextElementSibling;
                
                button.setAttribute('aria-expanded', !expanded);
                content.hidden = expanded;
            });
        });

        // Quick Nav - Scroll to section and expand
        document.querySelectorAll('.nav-item').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.getAttribute('data-section');
                const section = document.getElementById(sectionId);
                
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // Expand the detail section
                    const toggle = section.querySelector('.detail-toggle');
                    if (toggle && toggle.getAttribute('aria-expanded') !== 'true') {
                        toggle.click();
                    }
                    
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                    link.classList.add('active');
                }
            });
        });

        // Mobile Jump Menu
        const jumpSelect = document.getElementById('jumpSelect');
        if (jumpSelect) {
            jumpSelect.addEventListener('change', (e) => {
                const sectionId = e.target.value;
                if (sectionId) {
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        const toggle = section.querySelector('.detail-toggle');
                        if (toggle && toggle.getAttribute('aria-expanded') !== 'true') {
                            toggle.click();
                        }
                    }
                    e.target.value = '';
                }
            });
        }

        // Scroll spy for active nav item
        const observerOptions = {
            root: null,
            rootMargin: '-50% 0px',
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    document.querySelectorAll('.nav-item').forEach(item => {
                        if (item.getAttribute('data-section') === id) {
                            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                            item.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        document.querySelectorAll('[id^="set-"], [id^="start-"], [id^="review-"], [id^="drag-"]').forEach(section => {
            observer.observe(section);
        });

        // AI Support Agent
        const openBtn = document.getElementById('openAiSupport');
        const closeBtn = document.getElementById('closeAiSupport');
        const collapsed = document.getElementById('aiSupportCollapsed');
        const expanded = document.getElementById('aiSupportExpanded');

        if (openBtn && closeBtn) {
            openBtn.addEventListener('click', () => {
                collapsed.style.display = 'none';
                expanded.style.display = 'block';
            });

            closeBtn.addEventListener('click', () => {
                expanded.style.display = 'none';
                collapsed.style.display = 'block';
            });
        }

        // Chat functionality (placeholder)
        const sendBtn = document.getElementById('sendMessage');
        const chatInput = document.getElementById('chatInput');
        const chatMessages = document.getElementById('chatMessages');

        if (sendBtn && chatInput && chatMessages) {
            sendBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });

            function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;

                // Add user message
                const userMsg = document.createElement('div');
                userMsg.style.cssText = 'background: var(--industrial-orange); color: white; padding: 0.75rem; border-radius: 4px; margin-bottom: 1rem; margin-left: 2rem;';
                userMsg.textContent = message;
                chatMessages.appendChild(userMsg);

                // Clear input
                chatInput.value = '';

                // Simulate agent response
                setTimeout(() => {
                    const agentMsg = document.createElement('div');
                    agentMsg.style.cssText = 'background: var(--bg-secondary); color: var(--text-primary); padding: 0.75rem; border-radius: 4px; margin-bottom: 1rem; margin-right: 2rem;';
                    agentMsg.textContent = 'Information about FocusHub is available in the sections above.';
                    chatMessages.appendChild(agentMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);

                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
    </script>

</body>
</html>
