<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusHub - Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg?v=2">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0e14;
            color: #e0e0e0;
            min-height: 100vh;
            padding: 1.5rem;
            font-size: 13px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .logo {
            height: 32px;
        }

        .streak-badge {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: 2px solid #FF8C5A;
        }

        /* AI Message - Front and Center */
        .ai-message {
            background: linear-gradient(135deg, #1a202c 0%, #111827 100%);
            border: 2px solid #374151;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .ai-icon {
            font-size: 32px;
            margin-bottom: 1rem;
        }

        .ai-text {
            font-size: 18px;
            line-height: 1.6;
            font-style: italic;
            color: #d1d5db;
            margin-bottom: 0.5rem;
        }

        .ai-attribution {
            text-align: right;
            color: #6b7280;
            font-size: 12px;
            font-weight: 600;
        }

        /* Compact Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: #111827;
            border: 2px solid #2d3748;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }

        .stat-label {
            font-size: 10px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            line-height: 1;
            color: #e0e0e0;
        }

        .stat-sublabel {
            font-size: 11px;
            color: #a8a8a8;
            margin-top: 0.25rem;
        }

        /* Visual Chart - Compact */
        .week-chart {
            background: #111827;
            border: 2px solid #2d3748;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 11px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            height: 80px;
            gap: 0.5rem;
        }

        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .bar {
            width: 100%;
            background: #374151;
            border-radius: 4px 4px 0 0;
            min-height: 4px;
            transition: all 0.3s;
            position: relative;
        }

        .bar.today {
            background: #2563EB;
        }

        .bar-label {
            font-size: 9px;
            color: #6b7280;
        }

        .bar-value {
            position: absolute;
            top: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 700;
            color: #e0e0e0;
        }

        /* CTA Button - Smaller */
        .btn-start {
            background: #e3302f;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            font-size: 14px;
            font-weight: 800;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            display: block;
            text-align: center;
            transition: all 0.2s;
            border: 2px solid #c72827;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-start:hover {
            background: #c72827;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(227, 48, 47, 0.3);
        }

        .grade-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 24px;
            font-weight: 800;
            border: 2px solid;
        }

        .grade-A { background: #22C55E; border-color: #16A34A; color: white; }
        .grade-B { background: #3B82F6; border-color: #2563EB; color: white; }
        .grade-C { background: #F59E0B; border-color: #D97706; color: white; }
        .grade-D { background: #EF4444; border-color: #DC2626; color: white; }
        .grade-F { background: #991B1B; border-color: #7F1D1D; color: white; }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .ai-text {
                font-size: 16px;
            }

            .stat-value {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="/logo.svg" alt="FocusHub" class="logo">
            <div class="streak-badge" id="streakBadge" style="display: none;">
                ðŸ”¥ <span id="streakCount">0</span>
            </div>
        </div>

        <!-- AI Message - FRONT AND CENTER -->
        <div class="ai-message">
            <div class="ai-icon">â—†</div>
            <p class="ai-text" id="reflection">Loading...</p>
            <p class="ai-attribution">â€” Your Accountability Partner</p>
        </div>

        <!-- Compact Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Yesterday</div>
                <div class="stat-value" id="yesterdaySprints">-</div>
                <div class="stat-sublabel">sprints</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Grade</div>
                <div class="stat-value">
                    <span class="grade-badge" id="yesterdayGrade">-</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">This Week</div>
                <div class="stat-value" id="weekSprints">0</div>
                <div class="stat-sublabel">total</div>
            </div>
        </div>

        <!-- Visual Week Chart -->
        <div class="week-chart">
            <div class="chart-title">Last 7 Days</div>
            <div class="chart-bars" id="chartBars">
                <!-- Generated by JS -->
            </div>
        </div>

        <!-- CTA -->
        <a href="/app.html" class="btn-start">Start Working â†’</a>
    </div>

    <script>
        // Load streak
        const streakData = JSON.parse(localStorage.getItem('focushub_streak') || '{"count": 0}');
        if (streakData.count > 0) {
            document.getElementById('streakCount').textContent = streakData.count;
            document.getElementById('streakBadge').style.display = 'flex';
        }

        // Load reflection
        const reflections = [
            'Sloth is a deadly sin not because God hates rest, but because wasted potential dishonors the gifts you\'ve been given. Use them.',
            'Discipline is a form of worship. Your focused work today echoes the patience of the saints who built cathedrals stone by stone.',
            'Offer it up. Your fatigue is real, but so is your duty. Christ carried the cross exhausted. You can carry these tasks.',
            'You were not promised comfort. You were promised meaning. Act accordingly.',
            'The spirit is willing but the flesh is weak. The system accounts for this. That\'s why you\'re tracking, not trusting yourself.',
            'God gave you time. What you do with it is your response to that gift. Make it count.',
            'Distraction is the enemy of devotion. Clear your workspace. Clear your mind. Focus.',
            'Small consistent acts of discipline compound into character. Your work today matters.',
            'You can\'t control outcomes. You can control showing up. Show up.',
            'The world needs what you can build when you stop procrastinating. Get to work.'
        ];

        const todayStr = new Date().toDateString();
        let dailyReflection = localStorage.getItem('focushub_home_reflection');
        let reflectionDate = localStorage.getItem('focushub_home_reflection_date');

        if (reflectionDate !== todayStr) {
            dailyReflection = reflections[Math.floor(Math.random() * reflections.length)];
            localStorage.setItem('focushub_home_reflection', dailyReflection);
            localStorage.setItem('focushub_home_reflection_date', todayStr);
        }

        document.getElementById('reflection').textContent = dailyReflection;

        // Load data
        const gradeHistory = JSON.parse(localStorage.getItem('focushub_grade_history') || '[]');
        
        // Yesterday
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        const yesterdayStr = yesterday.toDateString();
        const yesterdayData = gradeHistory.find(entry => entry.date === yesterdayStr);
        
        if (yesterdayData) {
            document.getElementById('yesterdaySprints').textContent = yesterdayData.sprintCount || 0;
            const gradeEl = document.getElementById('yesterdayGrade');
            gradeEl.textContent = yesterdayData.grade || 'F';
            gradeEl.className = 'grade-badge grade-' + (yesterdayData.grade || 'F');
        }

        // This week
        const weekSprints = gradeHistory
            .filter(entry => {
                const entryDate = new Date(entry.date);
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                return entryDate >= weekAgo;
            })
            .reduce((sum, entry) => sum + (entry.sprintCount || 0), 0);

        document.getElementById('weekSprints').textContent = weekSprints;

        // Chart
        const chartBars = document.getElementById('chartBars');
        const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const last7Days = [];
        
        for (let i = 6; i >= 0; i--) {
            const date = new Date();
            date.setDate(date.getDate() - i);
            const dateStr = date.toDateString();
            const dayData = gradeHistory.find(entry => entry.date === dateStr);
            const sprints = dayData ? dayData.sprintCount || 0 : 0;
            const dayName = days[date.getDay() === 0 ? 6 : date.getDay() - 1];
            last7Days.push({ sprints, day: i === 0 ? 'Today' : dayName, isToday: i === 0 });
        }

        const maxSprints = Math.max(...last7Days.map(d => d.sprints), 1);
        
        last7Days.forEach(day => {
            const barItem = document.createElement('div');
            barItem.className = 'bar-item';
            
            const height = (day.sprints / maxSprints) * 100;
            const bar = document.createElement('div');
            bar.className = day.isToday ? 'bar today' : 'bar';
            bar.style.height = height + '%';
            
            if (day.sprints > 0) {
                const value = document.createElement('span');
                value.className = 'bar-value';
                value.textContent = day.sprints;
                bar.appendChild(value);
            }
            
            const label = document.createElement('div');
            label.className = 'bar-label';
            label.textContent = day.day;
            
            barItem.appendChild(bar);
            barItem.appendChild(label);
            chartBars.appendChild(barItem);
        });
    </script>
</body>
</html>
